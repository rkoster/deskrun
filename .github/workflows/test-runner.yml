name: Test Self-Hosted Runner

on:
  push:
    branches: [copilot/implement-github-actions-runner]
  workflow_dispatch:

jobs:
  test:
    runs-on: test-runner
    container:
      image: ubuntu:22.04
      options: --privileged
    steps:
      - uses: actions/checkout@v4
      - name: Run simple test
        run: |
          echo "Running on ARC scale set runner in container"
          echo "Hostname: $(hostname)"
          echo "Username: $(whoami)"
          id
      - name: Test container environment
        run: |
          echo "Testing container environment"
          cat /etc/os-release
          echo "---"
          apt-get update -qq && apt-get install -y -qq curl > /dev/null 2>&1
          curl --version
      - name: Test Docker in container
        run: |
          echo "Testing Docker availability"
          docker ps 2>/dev/null && echo "Docker is available" || echo "Docker not available"
          docker --version 2>/dev/null || echo "Docker not installed"
